<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Connected Users</title>
  <script src="//code.jquery.com/jquery-1.11.1.min.js" type="text/javascript"></script>
  <script src="//cdn.datatables.net/1.10.3/js/jquery.dataTables.min.js" type="text/javascript"></script>
  <link href="//cdn.datatables.net/1.10.3/css/jquery.dataTables.css" rel="stylesheet" type="text/css">
</head>

<body>
  <table id="test" class="display" with="100%" cellspacing="0" border=1>
    <thead>
      <tr>
        <th>name</th>
        <th>conn</th>
        <th>type</th>
        <th>real</th>
        <th>virt</th>
        <th>cons</th>
        <th>cont</th>
        <th>recv</th>
        <th>sent</th>
        <th>kill</th>
      </tr>
    </thead>
  </table>

  <script>
$(document).ready(function() {
    $('#test').dataTable( {
        "processing": true,
        "paging": false,
        "searching": false,
        "ajax": {
            "url": "//10.100.165.212:8080/connected_users",
            "dataType": "jsonp",
            "dataSrc": function ( json ) {
                for (var i = 0, ien = json.data.length; i < ien; i++) {

                    // kill
                    realip = json.data[i].realip
                    if realip {
                        json.data[i].kill = '<a href="//10.100.165.212:8080/kill_user/' + realip + '">kill</a>'
                    } else {
                        json.data[i].kill = ''
                    }

                    // conn
                    connected = json.data[i].connected
                    if connected == 0 {
                        json.data[i].connected = '<img src="graphics/red.png" alt="not connected" style="width:20px;height:20px">'
                    } else {
                        json.data[i].connected = '<img src="graphics/green.png" alt="connected" style="width:20px;height:20px">'
                    }

                    console.log(json.data[i]);
                }
                return json.data;
            }
        },
        "columns": [
            { "data": "name" },
            { "data": "connected" },
            { "data": "type" },
            { "data": "realip" },
            { "data": "virtips" },
            { "data": "cons" },
            { "data": "cont" },
            { "data": "recv" },
            { "data": "sent" },
            { "data": "kill" },
        ]
    } );
} );
  </script>

</body>
</html>
