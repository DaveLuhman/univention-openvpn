# Warning: This file is auto-generated and might be overwritten by
#          univention-config-registry.
#          Please edit the following file(s) instead:
# Warnung: Diese Datei wurde automatisch generiert und kann durch
#          univention-config-registry Ã¼berschrieben werden.
#          Bitte bearbeiten Sie an Stelle dessen die folgende(n) Datei(en):
# 
#     /etc/univention/templates/files/etc/pam.d/openvpn
# 

@!@
hostname = configRegistry.get('hostname')
domainname = configRegistry.get('domainname')
url = configRegistry.get('privacyidea/pam/url', 'https://%s.%s/privacyidea' % (hostname, domainname))
prompt = configRegistry.get('privacyidea/pam/prompt', 'OTP: ')
realm = configRegistry.get('privacyidea/pam/realm', '')

pam_config = '''
auth     sufficient     pam_python.so /usr/share/privacyidea/privacyidea_pam.py url={} prompt={} realm={} cacerts=/etc/univention/ssl/ucsCA/CAcert.pem
'''.format(url, prompt, realm)

if configRegistry.is_true('privacyidea/pam/enable', False):
        print(pam_config)

@!@

@include ldaponly-auth

@include common-account
@include common-session
@include common-password
